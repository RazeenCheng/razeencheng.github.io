<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 3.9.0"><link rel="apple-touch-icon" sizes="180x180" href="https://st.razeen.cn/static/img/avatar.png"><link rel="icon" type="image/png" sizes="32x32" href="https://st.razeen.cn/static/img/avatar.png"><link rel="icon" type="image/png" sizes="16x16" href="https://st.razeen.cn/static/img/avatar.png"><link rel="mask-icon" href="https://st.razeen.cn/static/img/avatar.png" color="#222"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="https://st.razeen.cn/next2021/lib/font-awesome/css/all.min.css"><link rel="stylesheet" href="https://st.razeen.cn/next2021/lib/fancybox/jquery.fancybox.min.css"><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:"razeencheng.com",root:"/",scheme:"Pisces",version:"7.8.0",exturl:!1,sidebar:{position:"right",display:"post",padding:18,offset:12,onmobile:!0},copycode:{enable:!0,show_result:!0,style:null},back2top:{enable:!0,sidebar:!1,scrollpercent:!1},bookmark:{enable:!1,color:"#222",save:"auto"},fancybox:!0,mediumzoom:!1,lazyload:!0,pangu:!1,comments:{style:"tabs",active:"disqus",storage:!0,lazyload:!1,nav:{gitalk:{text:"Gitalk",order:-1},disqus:{text:"Disqus",order:-2}},activeClass:"disqus"},algolia:{appID:"XUUWC2A8SN",apiKey:"8b6cfdd6ec397436fa16561c1bb8f526",indexName:"razeenblog",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!0,trigger:"auto",top_n_per_article:1,unescape:!1,preload:!1},motion:{enable:!1,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},path:"search.xml"}</script><meta name="description" content="在开发的过程中，经常需要处理一些重复的工作，或者逻辑相当简单但耗时的功能，这时我们可能会考虑到用脚本来自动化完成这些工作。而 Bash 脚本是我们最容易接触到和上手的脚本语言。这篇博客汇总一些常用的 Bash 语法，方便日后查阅学习。"><meta name="keywords" content="bash的使用 - shell的使用"><meta property="og:type" content="article"><meta property="og:title" content="终极 Bash 脚本指南"><meta property="og:url" content="https://razeencheng.com/post/the-ultimate-programmers-guide-to-bash-scripting.html"><meta property="og:site_name" content="Razeen`s Blog"><meta property="og:description" content="在开发的过程中，经常需要处理一些重复的工作，或者逻辑相当简单但耗时的功能，这时我们可能会考虑到用脚本来自动化完成这些工作。而 Bash 脚本是我们最容易接触到和上手的脚本语言。这篇博客汇总一些常用的 Bash 语法，方便日后查阅学习。"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2021-07-10T09:23:16.412Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="终极 Bash 脚本指南"><meta name="twitter:description" content="在开发的过程中，经常需要处理一些重复的工作，或者逻辑相当简单但耗时的功能，这时我们可能会考虑到用脚本来自动化完成这些工作。而 Bash 脚本是我们最容易接触到和上手的脚本语言。这篇博客汇总一些常用的 Bash 语法，方便日后查阅学习。"><link rel="canonical" href="https://razeencheng.com/post/the-ultimate-programmers-guide-to-bash-scripting.html"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0,lang:"zh-CN"}</script><title>终极 Bash 脚本指南 | Razeen`s Blog</title><script async src="https://www.googletagmanager.com/gtag/js?id=UA-82194091-1"></script><script>function gtag(){dataLayer.push(arguments)}CONFIG.hostname===location.hostname&&(window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-82194091-1"))</script><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?e9d432ff1948379070213295f6a8068f";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript><script data-ad-client="ca-pub-4450478767591566" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script></head><body itemscope itemtype="http://schema.org/WebPage"><div class="container"><div class="headband"></div><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏"><span class="toggle-line toggle-line-first"></span> <span class="toggle-line toggle-line-middle"></span> <span class="toggle-line toggle-line-last"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span><h1 class="site-title">Razeen`s Blog</h1><span class="logo-line-after"><i></i></span></a><p class="site-subtitle" itemprop="description">Stay hungry, Stay foolish.</p></div><div class="site-nav-right"><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul id="menu" class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">61</span></a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">25</span></a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">89</span></a></li><li class="menu-item menu-item-reading"><a href="/reading/" rel="section"><i class="fa fa-book fa-fw"></i>读书</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"><input autocomplete="off" autocapitalize="off" placeholder="搜索..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div><div id="search-result"><div id="no-result"><i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i></div></div></div></div></div></header><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span>0%</span></div><main class="main"><div class="main-inner"><div class="content-wrap"><div class="content post posts-expand"><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://razeencheng.com/post/the-ultimate-programmers-guide-to-bash-scripting.html"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="https://st.razeen.cn/static/img/avatar.png"><meta itemprop="name" content="Razeen"><meta itemprop="description" content="My name is ChengJin, I use @Razeen and @RazeenCheng on web. I'm a gopher+. Currently I'm working for a company about information security."></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Razeen`s Blog"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">终极 Bash 脚本指南</h1><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2021-02-01 19:46:58" itemprop="dateCreated datePublished" datetime="2021-02-01T19:46:58+00:00">2021-02-01</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">分类在</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/about-linux/" itemprop="url" rel="index"><span itemprop="name">Linux 点滴</span></a></span></span></div></header><div class="post-body" itemprop="articleBody"><p>在开发的过程中，经常需要处理一些重复的工作，或者逻辑相当简单但耗时的功能，这时我们可能会考虑到用脚本来自动化完成这些工作。而 Bash 脚本是我们最容易接触到和上手的脚本语言。</p><p>这篇博客汇总一些常用的 Bash 语法，方便日后查阅学习。</p><a id="more"></a><h3 id="hello-world"><a href="#hello-world" class="headerlink" title="hello world"></a>hello world</h3><p>不管写啥，上来先输出个<code>hello world</code>。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"hello world"</span></span><br></pre></td></tr></table></figure><p>创建一个文件<code>hello.sh</code> 包含以上内容，同时赋予执行权限，然后执行，一个<code>hello world</code> 就好了。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 添加执行权限</span></span><br><span class="line">$ chmod +x hello.sh</span><br><span class="line"></span><br><span class="line">$ ./hello.sh</span><br><span class="line">hello world</span><br></pre></td></tr></table></figure><h3 id="解释器"><a href="#解释器" class="headerlink" title="解释器"></a>解释器</h3><p>我们看到这个<code>hello.sh</code> 脚本，第一行有个 <code>#!/bin/bash</code> 。 这个是用来指定该脚本在 UNIX/Linux 下执行时用到的解释器。</p><p>执行<code>cat /etc/shells</code> 我们可以看到自己的系统中都有哪些解释器。如我的：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">$ cat /etc/shells</span><br><span class="line"><span class="comment"># /etc/shells: valid login shells</span></span><br><span class="line">/bin/sh</span><br><span class="line">/bin/bash</span><br><span class="line">/usr/bin/bash</span><br><span class="line">/bin/rbash</span><br><span class="line">/usr/bin/rbash</span><br><span class="line">/bin/dash</span><br><span class="line">/usr/bin/dash</span><br><span class="line">/bin/zsh</span><br><span class="line">/usr/bin/zsh</span><br><span class="line">/usr/bin/tmux</span><br></pre></td></tr></table></figure><h3 id="注释"><a href="#注释" class="headerlink" title="注释"></a>注释</h3><p>用 <code>#</code> 来注释。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment"># 这是注释</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"hello world"</span></span><br></pre></td></tr></table></figure><h3 id="变量声明"><a href="#变量声明" class="headerlink" title="变量声明"></a>变量声明</h3><p>Bash 中变量命名是大小写敏感的，很多喜欢全大写。当然你也可以使用 小写英文字母，数字和下划线，但不能以数字开头。 给变量赋值的时候 <code>=</code> 号前后不能有空格。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 有效的</span></span><br><span class="line">FIRSTLETTERS=<span class="string">"ABC"</span></span><br><span class="line">FIRST_THREE_LETTERS=<span class="string">"ABC"</span></span><br><span class="line">firstThreeLetters=<span class="string">"ABC"</span></span><br><span class="line">MY_SHELL=<span class="string">"bash"</span></span><br><span class="line">my_another_shell=<span class="string">"my another shell"</span></span><br><span class="line">My_Shell=<span class="string">"My shell"</span></span><br><span class="line">_myshell=<span class="string">"My shell"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 无效的</span></span><br><span class="line">3LETTERS=<span class="string">"ABC"</span></span><br><span class="line">first-three-letters=<span class="string">"ABC"</span></span><br><span class="line">first@Thtree@Letters=<span class="string">"ABC"</span></span><br><span class="line">ABC = <span class="string">"ABC "</span></span><br><span class="line">MY_SHELL = <span class="string">"bash"</span></span><br><span class="line">My-SHELL=<span class="string">"bash"</span></span><br><span class="line">1MY_SHELL=<span class="string">"My shell"</span></span><br></pre></td></tr></table></figure><h3 id="变量引用"><a href="#变量引用" class="headerlink" title="变量引用"></a>变量引用</h3><p>当你要使用变量的时候，用 <code>$</code> 来引用， 如果后面要接一些其他字符，可以用<code>{}</code> 括起来。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line">WORLD=<span class="string">"world world"</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"hello <span class="variable">$WORLD</span>"</span>  <span class="comment"># hello world world</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"hello <span class="variable">$&#123;WORLD&#125;</span>2"</span> <span class="comment"># hello world world2</span></span><br></pre></td></tr></table></figure><p>在 Bash 中要注意 单引号 <code>&#39;</code> , 双引号 <code>&quot;</code> ,反引号 ` 的区别。</p><p>单引号，双引号都能用来保留引号内的为文字值，其差别在于，双引号在遇到 <code>$(参数替换)</code> , 反引号 `(命令替换) 的时候有例外，单引号则剥夺其中所有字符的特殊含义。</p><p>而反引号的作用 和 <code>$()</code> 是差不多的。 在执行一条命令的时候，会先执行其中的命令，再把结果放到原命令中。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line">var=<span class="string">"music"</span></span><br><span class="line">sports=<span class="string">'sports'</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"I like <span class="variable">$var</span>"</span>   <span class="comment"># I like music</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"I like <span class="variable">$&#123;var&#125;</span>"</span> <span class="comment"># I like music</span></span><br><span class="line"><span class="built_in">echo</span> I like <span class="variable">$var</span>     <span class="comment"># I like music</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">'I like $var'</span>   <span class="comment"># I like $var</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"I like \$var"</span>  <span class="comment"># I like $var</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">'I like \$var'</span>  <span class="comment"># I like \$var</span></span><br><span class="line"><span class="built_in">echo</span> `bash -version` <span class="comment"># GNU bash, version 5.0.17(1)-release (x86_64-pc-linux-gnu)...</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">'bash -version'</span> <span class="comment"># bash -version</span></span><br></pre></td></tr></table></figure><h3 id="环境变量"><a href="#环境变量" class="headerlink" title="环境变量"></a>环境变量</h3><p>Linux 的环境变量包含了存储在系统中的信息。我们可以在终端中找到一些环境变量。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ env </span><br><span class="line"><span class="comment"># 或</span></span><br><span class="line">$ printenv</span><br></pre></td></tr></table></figure><p>你可以在脚本中引用这些环境变量。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$SHELL</span>, <span class="variable">$USER</span>, <span class="variable">$HOME</span> </span><br><span class="line"></span><br><span class="line"><span class="comment"># /usr/bin/zsh, razeen, /home/razeen</span></span><br></pre></td></tr></table></figure><p><a href="https://tldp.org/LDP/Bash-Beginners-Guide/html/sect_03_02.html" target="_blank" rel="noopener">这里</a> 还有更多。</p><h3 id="内部变量"><a href="#内部变量" class="headerlink" title="内部变量"></a>内部变量</h3><p>Bash 的内部变量也不少，有时我们可能会用到，如 <code>$BASHPID</code> <code>$IFS</code> <code>$PWD</code> 等，更多看<a href="https://tldp.org/LDP/abs/html/internalvariables.html" target="_blank" rel="noopener">这里</a> 。</p><h3 id="将命令输出分配给变量"><a href="#将命令输出分配给变量" class="headerlink" title="将命令输出分配给变量"></a>将命令输出分配给变量</h3><p>可以使用 <code>$(command)</code> 将命令输出存储在变量中。例如这是一个<code>info.sh</code>脚本内容:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line">LIST=$(ls -l)</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"File information: <span class="variable">$LIST</span>"</span></span><br></pre></td></tr></table></figure><p>执行（别忘了给执行权限）</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ ./info.sh</span><br><span class="line">File information: total 8</span><br><span class="line">-rwxrwxr-x 1 razeen razeen 85 2月   5 07:35 hello.sh</span><br><span class="line">-rwxrwxr-x 1 razeen razeen 58 2月   5 07:36 info.sh</span><br></pre></td></tr></table></figure><p>下面的脚本会将时间和日期，用户名以及系统正常运行时间保存到日志文件中。</p><p>其中 <code>&gt;</code> 是重定向之一，它将覆盖文件。使用 <code>&gt;&gt;</code> 可以将输出追加到文件。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line">DATE=$(date -u) <span class="comment"># UTC 时间#!/bin/bash</span></span><br><span class="line">DATE=$(date -u) <span class="comment"># UTC 时间</span></span><br><span class="line">WHO=$(whoami) <span class="comment"># 用户名</span></span><br><span class="line">UPTIME=$(uptime) <span class="comment"># 系统运行时间</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"Today is <span class="variable">$DATE</span>. You are <span class="variable">$WHO</span>. Uptime info: <span class="variable">$UPTIME</span>"</span> &gt; logfile</span><br><span class="line">WHO=$(whoami) <span class="comment"># 用户名</span></span><br><span class="line">UPTIME=$(uptime) <span class="comment"># 系统运行时间</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"Today is <span class="variable">$DATE</span>. You are <span class="variable">$WHO</span>. Uptime info: <span class="variable">$UPTIME</span>"</span> &gt; logfile</span><br></pre></td></tr></table></figure><p><img data-src="https://st.razeen.cn/img/20210205074148_image-20210205074148588.png" alt="image-20210205074148588"></p><h3 id="内建命令"><a href="#内建命令" class="headerlink" title="内建命令"></a>内建命令</h3><p><code>Shell</code> 内建命令是可以直接在<code>Shell</code>中运行的命令。可以这么查看内建命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">$ compgen -b | sort</span><br><span class="line">-</span><br><span class="line">.</span><br><span class="line">:</span><br><span class="line">[</span><br><span class="line"><span class="built_in">alias</span></span><br><span class="line"><span class="built_in">autoload</span></span><br><span class="line"><span class="built_in">bg</span></span><br><span class="line"><span class="built_in">bindkey</span></span><br><span class="line"><span class="built_in">break</span></span><br><span class="line"><span class="built_in">builtin</span></span><br><span class="line"><span class="built_in">bye</span></span><br><span class="line"><span class="built_in">cd</span></span><br></pre></td></tr></table></figure><p>也可以用 <code>type</code> 查看命令的类型。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">type</span> <span class="built_in">cd</span></span><br><span class="line"><span class="built_in">cd</span> is a shell <span class="built_in">builtin</span></span><br></pre></td></tr></table></figure><p>可以用 <code>which</code> 命令查看可执行文件的文件路径：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># which sort</span></span><br><span class="line">/usr/bin/sort</span><br></pre></td></tr></table></figure><p>可通过 <code>man builtins</code> 查看内建命令的详细描述。</p><h3 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h3><h4 id="IF条件表达式"><a href="#IF条件表达式" class="headerlink" title="IF条件表达式"></a>IF条件表达式</h4><p><code>if</code> 后面需要接者<code>then</code>：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> [ condition-for-test ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">  <span class="built_in">command</span></span><br><span class="line">  ...</span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure><p>或者，</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> [ condition-for-test ]; <span class="keyword">then</span></span><br><span class="line">  <span class="built_in">command</span></span><br><span class="line">  ...</span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure><p>如：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"> </span><br><span class="line">VAR=myvar</span><br><span class="line"><span class="keyword">if</span> [ <span class="variable">$VAR</span> = myvar ]; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"1: \$VAR is <span class="variable">$VAR</span>"</span>   <span class="comment"># 1: $VAR is myvar</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="keyword">if</span> [ <span class="string">"<span class="variable">$VAR</span>"</span> = myvar ]; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"2: \$VAR is <span class="variable">$VAR</span>"</span>   <span class="comment"># 2: $VAR is myvar</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="keyword">if</span> [ <span class="variable">$VAR</span> = <span class="string">"myvar"</span> ]; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"3: \$VAR is <span class="variable">$VAR</span>"</span>   <span class="comment"># 3: $VAR is myvar</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="keyword">if</span> [ <span class="string">"<span class="variable">$VAR</span>"</span> = <span class="string">"myvar"</span> ]; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"4: \$VAR is <span class="variable">$VAR</span>"</span>   <span class="comment"># 4: $VAR is myvar</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure><p>上面，我们在比较时，可以用双引号把变量引用起来。</p><p>但要注意单引号的使用。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line">VAR=myvar</span><br><span class="line"><span class="keyword">if</span> [ <span class="string">'$VAR'</span> = <span class="string">'myvar'</span> ]; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">'5a: $VAR is $VAR'</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"5b: Not equal."</span></span><br><span class="line">fibas</span><br><span class="line"><span class="comment"># Output:</span></span><br><span class="line"><span class="comment"># 5b: Not equal.</span></span><br></pre></td></tr></table></figure><p>上面这个就把 ‘$VAR’ 当一个字符串了。</p><p>但如果变量是多个单词，我们就必须用到双引号了，如</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 这样写就有问题</span></span><br><span class="line">VAR1=<span class="string">"my var"</span></span><br><span class="line"><span class="keyword">if</span> [ <span class="variable">$VAR1</span> = <span class="string">"my var"</span> ]; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"\$VAR1 is <span class="variable">$VAR1</span>"</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="comment"># Output</span></span><br><span class="line"><span class="comment"># error [: too many arguments</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 用双引号</span></span><br><span class="line"><span class="keyword">if</span> [ <span class="string">"<span class="variable">$VAR1</span>"</span> = <span class="string">"my var"</span> ]; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"\$VAR1 is <span class="variable">$VAR1</span>"</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure><p>总的来说，双引号可以一直加上。</p><h4 id="空格问题"><a href="#空格问题" class="headerlink" title="空格问题"></a>空格问题</h4><p>比较表达式中，如果<code>=</code>前后没有空格，那么整个表法式会被认为是一个单词，其判断结果为<code>True</code>.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"> </span><br><span class="line">VAR2=2</span><br><span class="line"><span class="comment">#  由于被识别成一个单词， [] 里面为 true</span></span><br><span class="line"><span class="keyword">if</span> [ <span class="string">"<span class="variable">$VAR2</span>"</span>=1 ]; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"<span class="variable">$VAR2</span> is 1."</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"<span class="variable">$VAR2</span> is not 1."</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="comment"># Output</span></span><br><span class="line"><span class="comment"># 2 is 1.</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 前后加上空格就好了</span></span><br><span class="line"><span class="keyword">if</span> [ <span class="string">"<span class="variable">$VAR2</span>"</span> = 1 ]; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"<span class="variable">$VAR2</span> is 1."</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"<span class="variable">$VAR2</span> is not 1."</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="comment"># Output</span></span><br><span class="line"><span class="comment"># 2 is not 1.</span></span><br></pre></td></tr></table></figure><p>另外需要注意的是， 在判断中，中括号 <code>[</code> 和变量之间一定要有一个空格，<code>=</code> 或者 <code>==</code>。 如果缺少了空格，你可能会到这类似这样的错误：<code>unary operator expected’ or missing</code>]` 。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 正确， 符号前后有空格</span></span><br><span class="line"><span class="keyword">if</span> [ <span class="variable">$VAR2</span> = 1 ]; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"\$VAR2 is 1."</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"It's not 1."</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="comment"># Output</span></span><br><span class="line"><span class="comment"># 2 is 1.</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 错误， 符号前后无空格</span></span><br><span class="line"><span class="keyword">if</span> [<span class="variable">$VAR2</span>=1]; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"<span class="variable">$VAR2</span> is 1."</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"It's not 1."</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="comment"># Output</span></span><br><span class="line"><span class="comment"># line 3: =1: command not found</span></span><br><span class="line"><span class="comment"># line 5: [=1]: command not found</span></span><br><span class="line"><span class="comment"># It's not 1.</span></span><br></pre></td></tr></table></figure><h4 id="文件测试表达式"><a href="#文件测试表达式" class="headerlink" title="文件测试表达式"></a>文件测试表达式</h4><p>对文件进行相关测试，判断的表达式如下：</p><table><thead><tr><th style="text-align:left">表达式</th><th style="text-align:left">True</th></tr></thead><tbody><tr><td style="text-align:left"><em>file1</em> -nt <em>file2</em></td><td style="text-align:left"><em>file1</em> 比 <em>file2</em> 新。</td></tr><tr><td style="text-align:left"><em>file1</em> -ot <em>file2</em></td><td style="text-align:left"><em>file1</em> 比 <em>file2</em> 老。</td></tr><tr><td style="text-align:left">-d <em>file</em></td><td style="text-align:left">文件<em>file</em>存在，且是一个文件夹。</td></tr><tr><td style="text-align:left">-e <em>file</em></td><td style="text-align:left">文件 <em>file</em> 存在。</td></tr><tr><td style="text-align:left">-f <em>file</em></td><td style="text-align:left">文件<em>file</em>存在，且为普通文件。</td></tr><tr><td style="text-align:left">-L <em>file</em></td><td style="text-align:left">文件<em>file</em>存在，且为符号连接。</td></tr><tr><td style="text-align:left">-O <em>file</em></td><td style="text-align:left">文件 <em>flle</em> 存在, 且由有效用户ID拥有。</td></tr><tr><td style="text-align:left">-r <em>file</em></td><td style="text-align:left">文件 <em>flle</em> 存在, 且是一个可读文件。</td></tr><tr><td style="text-align:left">-s <em>file</em></td><td style="text-align:left">文件 <em>flle</em> 存在, 且长度大于0。</td></tr><tr><td style="text-align:left">-w file</td><td style="text-align:left">文件 <em>flle</em> 可写入。</td></tr><tr><td style="text-align:left">-x file</td><td style="text-align:left">文件 <em>flle</em> 可写执行。</td></tr></tbody></table><p>可以使用<code>man test</code>查看那详细的说明。</p><p>当表达式为<code>True</code>时，测试命令返回退出状态 0，而表达式为<code>False</code>时返回退出状态1。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line">FILE=<span class="string">"/etc/resolv.conf"</span></span><br><span class="line"><span class="keyword">if</span> [ -e <span class="string">"<span class="variable">$FILE</span>"</span> ]; <span class="keyword">then</span></span><br><span class="line">  <span class="keyword">if</span> [ -f <span class="string">"<span class="variable">$FILE</span>"</span> ]; <span class="keyword">then</span></span><br><span class="line">      <span class="built_in">echo</span> <span class="string">"<span class="variable">$FILE</span> is a file."</span></span><br><span class="line">  <span class="keyword">fi</span></span><br><span class="line">  <span class="keyword">if</span> [ -d <span class="string">"<span class="variable">$FILE</span>"</span> ]; <span class="keyword">then</span></span><br><span class="line">      <span class="built_in">echo</span> <span class="string">"<span class="variable">$FILE</span> is a directory."</span></span><br><span class="line">  <span class="keyword">fi</span></span><br><span class="line">  <span class="keyword">if</span> [ -r <span class="string">"<span class="variable">$FILE</span>"</span> ]; <span class="keyword">then</span></span><br><span class="line">      <span class="built_in">echo</span> <span class="string">"<span class="variable">$FILE</span> is readable."</span></span><br><span class="line">  <span class="keyword">fi</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure><h4 id="字符串比较表达式"><a href="#字符串比较表达式" class="headerlink" title="字符串比较表达式"></a>字符串比较表达式</h4><table><thead><tr><th style="text-align:left">表达式</th><th style="text-align:left">True</th></tr></thead><tbody><tr><td style="text-align:left"><em>string1 = string2</em> 或 <em>string1 == string2</em></td><td style="text-align:left">两字符相等</td></tr><tr><td style="text-align:left"><em>string1</em> != <em>string2</em></td><td style="text-align:left">两个字符串不相等</td></tr><tr><td style="text-align:left"><em>string1</em> &gt; <em>string2</em></td><td style="text-align:left"><em>string1</em> 大于 <em>string2</em>.</td></tr><tr><td style="text-align:left"><em>string1</em> &lt; <em>string2</em></td><td style="text-align:left"><em>string1</em> 小于<em>string2</em>.</td></tr><tr><td style="text-align:left">-n <em>string</em></td><td style="text-align:left">字符串长度大于0</td></tr><tr><td style="text-align:left">-z <em>string</em></td><td style="text-align:left">字符串长度等于0</td></tr></tbody></table><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line">STRING=<span class="string">""</span></span><br><span class="line"><span class="keyword">if</span> [ -z <span class="string">"<span class="variable">$STRING</span>"</span> ]; <span class="keyword">then</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">"There is no string."</span> &gt;&amp;2 </span><br><span class="line">  <span class="built_in">exit</span> 1</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Output</span></span><br><span class="line"><span class="comment"># There is no string.</span></span><br></pre></td></tr></table></figure><p>其中<code>&gt;&amp;2</code>将错误信息定位到标准错误输出。</p><h4 id="数字比较表达式"><a href="#数字比较表达式" class="headerlink" title="数字比较表达式"></a>数字比较表达式</h4><p>下面这些是用来比较数字的一些表达式。</p><table><thead><tr><th style="text-align:left">[…]</th><th style="text-align:left">((…))</th><th style="text-align:left">True</th></tr></thead><tbody><tr><td style="text-align:left">[ “int1” -eq “int2” ]</td><td style="text-align:left">(( “int1” == “int2” ))</td><td style="text-align:left">相等.</td></tr><tr><td style="text-align:left">[ “int1” -nq “int2” ]</td><td style="text-align:left">(( “int1” != “int2” ))</td><td style="text-align:left">不等.</td></tr><tr><td style="text-align:left">[ “int1” -lt “int2” ]</td><td style="text-align:left">(( “int1” &lt; “int2” ))</td><td style="text-align:left">int2 大于 int1.</td></tr><tr><td style="text-align:left">[ “int1” -le “int2” ]</td><td style="text-align:left">(( “int1” &lt;= “int2” ))</td><td style="text-align:left">int2 大于等于 int1.</td></tr><tr><td style="text-align:left">[ “int1” -gt “int2” ]</td><td style="text-align:left">(( “int1 &gt; “int2” ))</td><td style="text-align:left">int1 大于 int2</td></tr><tr><td style="text-align:left">[ “int1” -ge “int2” ]</td><td style="text-align:left">(( “int1 &gt;= “int2” ))</td><td style="text-align:left">int1 大于等于 int2</td></tr></tbody></table><h4 id="双括号"><a href="#双括号" class="headerlink" title="双括号 (())"></a>双括号 <code>(())</code></h4><p>数值的比较或者计算可以用<code>((... ))</code>。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line">a=3</span><br><span class="line">b=4</span><br><span class="line">c=3</span><br><span class="line"><span class="keyword">if</span> ((<span class="string">"<span class="variable">$a</span>"</span> &lt; <span class="string">"<span class="variable">$b</span>"</span>)); <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"<span class="variable">$a</span> is less than <span class="variable">$b</span>."</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"<span class="variable">$a</span> is not less than <span class="variable">$b</span>."</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="keyword">if</span> ((<span class="string">"<span class="variable">$a</span>"</span> != <span class="string">"<span class="variable">$c</span>"</span>)); <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"<span class="variable">$a</span> is not equal to <span class="variable">$c</span>."</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"<span class="variable">$a</span> is equal to <span class="variable">$c</span>."</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"<span class="variable">$a</span> + <span class="variable">$b</span> = <span class="variable">$(($a + $b)</span>)"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Output</span></span><br><span class="line"><span class="comment"># 3 is less than 4.</span></span><br><span class="line"><span class="comment"># 3 is equal to 3.</span></span><br><span class="line"><span class="comment"># 3 + 4 = 7</span></span><br></pre></td></tr></table></figure><h3 id="怎么使用-if-else-和-if-elif-else"><a href="#怎么使用-if-else-和-if-elif-else" class="headerlink" title="怎么使用 if/else 和 if/elif/else"></a>怎么使用 if/else 和 if/elif/else</h3><p>其实上面已经展示了不少了，这里总结下<code>if...else</code> 和 <code>if...elif...else</code> 语句。</p><p><code>if/else</code> 语句格式如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> [ condition-is-true ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">  <span class="built_in">command</span> A</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">  <span class="built_in">command</span> B</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 或</span></span><br><span class="line"><span class="keyword">if</span> [ condition-is-true ]; <span class="keyword">then</span></span><br><span class="line">  <span class="built_in">command</span> A</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">  <span class="built_in">command</span> B</span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure><p>例如:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line">MY_SHELL=<span class="string">"csh"</span></span><br><span class="line"><span class="keyword">if</span> [ <span class="string">"<span class="variable">$MY_SHELL</span>"</span> = <span class="string">"bash"</span> ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">"You are using the bash shell."</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">"You are not using the bash shell."</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure><p><code>if/elif/else</code> 语句格式如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> [ condition-is-true ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">  <span class="built_in">command</span> A</span><br><span class="line"><span class="keyword">elif</span> [ condition-is-true ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">  <span class="built_in">command</span> B</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">  <span class="built_in">command</span> C</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="comment"># or</span></span><br><span class="line"><span class="keyword">if</span> [ condition-is-true ]; <span class="keyword">then</span></span><br><span class="line">  <span class="built_in">command</span> A</span><br><span class="line"><span class="keyword">elif</span> [ condition-is-true ]; <span class="keyword">then</span></span><br><span class="line">  <span class="built_in">command</span> B</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">  <span class="built_in">command</span> C</span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure><p>如:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line">MY_SHELL=<span class="string">"csh"</span></span><br><span class="line"><span class="keyword">if</span> [ <span class="string">"<span class="variable">$MY_SHELL</span>"</span> = <span class="string">"bash"</span> ]; <span class="keyword">then</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">"You are using the bash shell."</span></span><br><span class="line"><span class="keyword">elif</span> [ <span class="string">"<span class="variable">$MY_SHELL</span>"</span> = <span class="string">"csh"</span> ]; <span class="keyword">then</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">"You are using csh."</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">"You are not using the bash shell."</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure><h3 id="双中括号的使用"><a href="#双中括号的使用" class="headerlink" title="双中括号的使用[[]]"></a>双中括号的使用<code>[[]]</code></h3><p>如用用于比较的变量不是单个单词，就需要<code>[[]]</code> , 或者用单中括号(这时需要加双引号)。 在平常的使用中，最好都使用<code>[[]]</code>。</p><p>与单中括号相比，双中括号具有其他功能。 如，可以对其中正则使用逻辑<code>&amp;&amp;</code>和<code>||</code>和<code>=〜</code>。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line">VAR1=<span class="string">"variable"</span></span><br><span class="line">VAR2=<span class="string">"variable 2"</span></span><br><span class="line"><span class="keyword">if</span> [[ (VAR1 == <span class="string">"variable"</span>)  ]]; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"They are the same."</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"Not the same."</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用 &amp;&amp;</span></span><br><span class="line">[[ (<span class="variable">$VAR1</span> == variable) &amp;&amp; (</span><br><span class="line"><span class="variable">$VAR2</span> == <span class="string">"variable 2"</span>) ]] &amp;&amp; <span class="built_in">echo</span> <span class="string">"They are the same again."</span></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line">digit=4</span><br><span class="line"><span class="keyword">if</span> [[ <span class="variable">$digit</span> =~ [0-9] ]]; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"<span class="variable">$digit</span> is a digit"</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"<span class="variable">$digit</span> isn't a digit"</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line">letter=<span class="string">"abc"</span></span><br><span class="line"><span class="keyword">if</span> [[ <span class="variable">$letter</span> =~ [0-9] ]]; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"<span class="variable">$letter</span> is a digit"</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"<span class="variable">$letter</span> isn't a digit"</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Output</span></span><br><span class="line"><span class="comment"># 4 is a digit</span></span><br><span class="line"><span class="comment"># abc isn't a digit</span></span><br></pre></td></tr></table></figure><h3 id="怎么使用-For-循环"><a href="#怎么使用-For-循环" class="headerlink" title="怎么使用 For 循环"></a>怎么使用 For 循环</h3><p><code>for</code>循环的使用如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> VARIABLE_NAME <span class="keyword">in</span> ITEM_1 ITEM_N</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  <span class="built_in">command</span> A</span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure><p>例如:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="keyword">for</span> COLOR <span class="keyword">in</span> red green blue</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">"COLOR: <span class="variable">$COLOR</span>"</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Output</span></span><br><span class="line"><span class="comment"># COLOR: red</span></span><br><span class="line"><span class="comment"># COLOR: green</span></span><br><span class="line"><span class="comment"># COLOR: blue</span></span><br></pre></td></tr></table></figure><p>可以在其中使用变量，如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line">COLORS=<span class="string">"red green blue"</span></span><br><span class="line"><span class="keyword">for</span> COLOR <span class="keyword">in</span> <span class="variable">$COLORS</span></span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">"COLOR: <span class="variable">$COLOR</span>"</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure><h4 id="用-for-循环重命名文件"><a href="#用-for-循环重命名文件" class="headerlink" title="用 for 循环重命名文件"></a>用 <code>for</code> 循环重命名文件</h4><p>我们举个简单的例子，用<code>for</code>循环重命名当前目录下的jpg图片。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line">IMGS=$(ls *jpg)</span><br><span class="line">DATE=$(date +%F)</span><br><span class="line"><span class="keyword">for</span> IMG <span class="keyword">in</span> <span class="variable">$IMGS</span></span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">"Renaming <span class="variable">$&#123;IMG&#125;</span> to <span class="variable">$&#123;DATE&#125;</span>-<span class="variable">$&#123;IMG&#125;</span>"</span></span><br><span class="line">  mv <span class="variable">$&#123;IMG&#125;</span> <span class="variable">$&#123;DATE&#125;</span>-<span class="variable">$&#123;IMG&#125;</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure><p><img data-src="https://st.razeen.cn/img/20210213170152_image-20210213170152011.png" alt="image-20210213170152011"></p><h3 id="怎么传参"><a href="#怎么传参" class="headerlink" title="怎么传参"></a>怎么传参</h3><p>执行脚本的时候，后面可以跟着很多参数，如：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ scriptname param1 param2 param3</span><br></pre></td></tr></table></figure><p><code>param1</code> 到 <code>param3</code> 称为可选参数， 可以在脚本中用 <code>$0</code>, <code>$1</code>, <code>$2</code>等，来引用这些参赛。例如:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"'\$0' is <span class="variable">$0</span>"</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"'\$1' is <span class="variable">$1</span>"</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"'\$2' is <span class="variable">$2</span>"</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"'\$3' is <span class="variable">$3</span>"</span></span><br></pre></td></tr></table></figure><p>输出:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ ./param.sh</span><br><span class="line"><span class="string">'$0'</span> is ./param.sh</span><br><span class="line"><span class="string">'$1'</span> is</span><br><span class="line"><span class="string">'$2'</span> is</span><br><span class="line"><span class="string">'$3'</span> is</span><br></pre></td></tr></table></figure><p><code>$0</code> 参数0返回的是当前执行文件的名字，包括路径。</p><p>可以用 <code>$@</code> 接受所以的参数。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="keyword">for</span> PARAM <span class="keyword">in</span> <span class="variable">$@</span></span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">"Param is: <span class="variable">$PARAM</span>"</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure><p>Using this script:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ ./params.sh a b c d e f</span><br><span class="line">Param is: a</span><br><span class="line">Param is: b</span><br><span class="line">Param is: c</span><br><span class="line">Param is: d</span><br><span class="line">Param is: e</span><br><span class="line">Param is: f</span><br></pre></td></tr></table></figure><h3 id="怎么接收用户输入"><a href="#怎么接收用户输入" class="headerlink" title="怎么接收用户输入"></a>怎么接收用户输入</h3><p>用户输入称为<code>STDIN</code>。可以将<code>read</code>命令与<code>-p</code>（提示）选项一起使用来读取用户输入，它将输出提示字符串。 <code>-r</code> 选项不允许反斜杠转义任何字符。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">read</span> -rp <span class="string">"PROMPT"</span> VARIABLE</span><br></pre></td></tr></table></figure><p>例如:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="built_in">read</span> -rp <span class="string">"Enter your programming languages: "</span> PROGRAMMES</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"Your programming languages are: "</span></span><br><span class="line"><span class="keyword">for</span> PROGRAMME <span class="keyword">in</span> <span class="variable">$PROGRAMMES</span>; <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"<span class="variable">$PROGRAMME</span> "</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure><p>运行:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ ./read.sh</span><br><span class="line">Enter your programming languages: go py</span><br><span class="line">Your programming languages are:</span><br><span class="line">go</span><br><span class="line">py</span><br></pre></td></tr></table></figure><h3 id="用大括号来表示范围"><a href="#用大括号来表示范围" class="headerlink" title="用大括号来表示范围 {}"></a>用大括号来表示范围 <code>{}</code></h3><p>如下所示，我们可以用大括号来表所一个数字或字母的范围。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">echo</span> &#123;0..3&#125;</span><br><span class="line">$ <span class="built_in">echo</span> &#123;a..d&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># output: </span></span><br><span class="line"><span class="comment"># 0 1 2 3</span></span><br><span class="line"><span class="comment"># a b c d</span></span><br></pre></td></tr></table></figure><p>你也可以在 <code>for</code> 循环中这么使用:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> &#123;0..9&#125;; </span><br><span class="line"><span class="keyword">do</span> </span><br><span class="line">  touch file_<span class="string">"<span class="variable">$i</span>"</span>.txt; </span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure><p>This will create different file names with different modification times.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ ls -al file_*</span><br><span class="line">-rw-rw-r-- 1 razeen razeen 0 2月  14 09:54 file_0.txt</span><br><span class="line">-rw-rw-r-- 1 razeen razeen 0 2月  14 09:54 file_1.txt</span><br><span class="line">-rw-rw-r-- 1 razeen razeen 0 2月  14 09:54 file_2.txt</span><br><span class="line">...</span><br></pre></td></tr></table></figure><h3 id="怎么使用While"><a href="#怎么使用While" class="headerlink" title="怎么使用While"></a>怎么使用While</h3><p>当 While 后的表达式结果为 <code>true</code>时，执行循环内语句。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line">i=1</span><br><span class="line"><span class="keyword">while</span> [ <span class="variable">$i</span> -le 5 ]; <span class="keyword">do</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="variable">$i</span></span><br><span class="line">  ((i++))</span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure><p>Output:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td></tr></table></figure><h3 id="退出码-返回码-是什么？"><a href="#退出码-返回码-是什么？" class="headerlink" title="退出码/返回码 是什么？"></a>退出码/返回码 是什么？</h3><p>每个命令都返回退出状态，范围为0-255。 0代表成功，非0代表错误。 可以用来进行错误检查。</p><table><thead><tr><th style="text-align:left">数值</th><th style="text-align:left">含义</th></tr></thead><tbody><tr><td style="text-align:left">0</td><td style="text-align:left">成功</td></tr><tr><td style="text-align:left">2</td><td style="text-align:left">返回内置命令，从而提示错误</td></tr><tr><td style="text-align:left">126</td><td style="text-align:left">命令找到了，但不是可执行的</td></tr><tr><td style="text-align:left">127</td><td style="text-align:left">没有找到命令</td></tr><tr><td style="text-align:left">128+N</td><td style="text-align:left">由于接收到信号N，命令退出</td></tr></tbody></table><h4 id="怎么检查退出码"><a href="#怎么检查退出码" class="headerlink" title="怎么检查退出码"></a>怎么检查退出码</h4><p><code>$?</code> 包含了上一条命令执行的返回码。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ ls ./no/exist</span><br><span class="line">ls: cannot access <span class="string">'./no/exist'</span>: No such file or directory</span><br><span class="line">$ <span class="built_in">echo</span> <span class="string">"$?"</span></span><br><span class="line">2</span><br></pre></td></tr></table></figure><p>如，在<code>if</code>表达式中检查返回码:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line">HOST=<span class="string">"razeen.cn"</span></span><br><span class="line">ping -c 1 <span class="variable">$HOST</span></span><br><span class="line">RETURN_CODE=$?</span><br><span class="line"><span class="keyword">if</span> [ <span class="string">"<span class="variable">$RETURN_CODE</span>"</span> -eq <span class="string">"0"</span> ]; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"<span class="variable">$HOST</span> reachable."</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"<span class="variable">$HOST</span> unreachable."</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure><p><code>-c 1</code> 参数表示发送一个可达包就停止发送。 然后我们检查一下<code>ping</code>执行的返回码。</p><p>输出:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ ./ex.sh</span><br><span class="line">PING razeen.cn (47.108.161.7) 56(84) bytes of data.</span><br><span class="line">64 bytes from 47.108.161.7 (47.108.161.7): icmp_seq=1 ttl=50 time=38.5 ms</span><br><span class="line"></span><br><span class="line">--- razeen.cn ping statistics ---</span><br><span class="line">1 packets transmitted, 1 received, 0% packet loss, time 0ms</span><br><span class="line">rtt min/avg/max/mdev = 38.541/38.541/38.541/0.000 ms</span><br><span class="line">razeen.cn reachable.</span><br></pre></td></tr></table></figure><h3 id="怎么连接多个命令"><a href="#怎么连接多个命令" class="headerlink" title="怎么连接多个命令"></a>怎么连接多个命令</h3><h4 id="逻辑运算符和命令退出状态"><a href="#逻辑运算符和命令退出状态" class="headerlink" title="逻辑运算符和命令退出状态"></a>逻辑运算符和命令退出状态</h4><p>执行命令后都有退出状态，我们可以使用 <code>&amp;&amp;</code> 和 <code>||</code>去决定下一步。</p><h4 id="退出命令"><a href="#退出命令" class="headerlink" title="退出命令"></a>退出命令</h4><p>你可以使用 <code>exit</code> 来决定退出码：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">exit 0</span><br><span class="line">exit 1</span><br><span class="line">exit 2</span><br><span class="line">etc.</span><br></pre></td></tr></table></figure><p>例如:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line">HOST=<span class="string">"razeen.cn"</span></span><br><span class="line">ping -c 1 <span class="variable">$HOST</span>  </span><br><span class="line"><span class="keyword">if</span> [ <span class="string">"$?"</span> -ne <span class="string">"0"</span> ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">"<span class="variable">$HOST</span> unreachable."</span></span><br><span class="line">  <span class="built_in">exit</span> 1</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="built_in">exit</span> 0</span><br></pre></td></tr></table></figure><p>我们可以将该脚本通过<code>&amp;&amp;</code>与其他脚本/命令连接。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ ./ex2.sh &amp;&amp; ls</span><br><span class="line">....</span><br><span class="line">2021-02-13-132m93.jpg   ex2.sh      file_1.txt  file_4.txt</span><br></pre></td></tr></table></figure><p>如果<code>./ex2.sh</code>返回状态码非0，后面的就不会执行。</p><h4 id="逻辑与-amp-amp"><a href="#逻辑与-amp-amp" class="headerlink" title="逻辑与 (&amp;&amp;)"></a>逻辑与 (&amp;&amp;)</h4><p>当<code>&amp;&amp;</code>前面的语句返回的状态码为<code>0</code>时，执行后面的语句。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir /tmp/bak &amp;&amp; cp test.txt /tmp/bak</span><br></pre></td></tr></table></figure><h4 id="逻辑或"><a href="#逻辑或" class="headerlink" title="逻辑或 (||)"></a>逻辑或 (||)</h4><p>当<code>||</code>前面的语句返回的状态码非<code>0</code>时（也就是执行失败），执行后面的语句。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp test.txt /tmp/bak/ || cp test.test.txt /tmp</span><br></pre></td></tr></table></figure><p>例如：</p><p>如果<code>ping</code>通了，就执行后面的输出。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line">host=<span class="string">"razeen.cn"</span></span><br><span class="line">ping -c 1 <span class="variable">$host</span> &amp;&amp; <span class="built_in">echo</span> <span class="string">"You can reach <span class="variable">$&#123;host&#125;</span>."</span></span><br></pre></td></tr></table></figure><p>如果<code>ping</code>失败了，就执行后面的输出。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line">host=<span class="string">"google.com"</span></span><br><span class="line">ping -c 1 <span class="variable">$host</span> || <span class="built_in">echo</span> <span class="string">"You can't reach <span class="variable">$&#123;host&#125;</span>."</span></span><br></pre></td></tr></table></figure><h4 id="分号"><a href="#分号" class="headerlink" title="分号 (;)"></a>分号 (;)</h4><p>分号不是一个逻辑运算符，但你可以用它来分割语句。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cp text.txt /tmp/bak/ ; cp test.txt /tmp</span><br><span class="line"><span class="comment"># 等同于</span></span><br><span class="line">cp text.txt /tmp/bak/  </span><br><span class="line">cp test.txt /tmp</span><br></pre></td></tr></table></figure><h3 id="管道"><a href="#管道" class="headerlink" title="管道 |"></a>管道 |</h3><p>管道<code>|</code>两侧的命令在各自的子shell中运行，并且两者同时启动。</p><p>如下：</p><p>第一个命令将目录更改为主目录，并列出文件和目录。</p><p>第二个命令仅显示执行该命令的文件和目录。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">echo</span> <span class="string">"<span class="variable">$(cd ~ &amp;&amp; ls)</span>"</span></span><br><span class="line">$ <span class="built_in">echo</span> <span class="string">"<span class="variable">$(cd ~ | ls)</span>"</span></span><br></pre></td></tr></table></figure><h3 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h3><p>在<code>Bash</code>中，你可以使用<code>function</code>或者直接定义一个函数。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="keyword">function</span>-<span class="function"><span class="title">name</span></span>()&#123;&#125;</span><br><span class="line"><span class="comment"># 或</span></span><br><span class="line"><span class="keyword">function</span>-<span class="function"><span class="title">name</span></span>()&#123;&#125;</span><br></pre></td></tr></table></figure><p>当你调用函数的时候，只需要函数名，不用带<code>()</code>。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">hello</span></span>()&#123;</span><br><span class="line">  <span class="built_in">echo</span> <span class="string">"Hello!"</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment"># 正确</span></span><br><span class="line">hello</span><br><span class="line"></span><br><span class="line"><span class="comment"># 错误</span></span><br><span class="line"><span class="comment"># hello()</span></span><br></pre></td></tr></table></figure><p>在函数中，可以调用其他函数。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">hello</span></span>()&#123;</span><br><span class="line">  <span class="built_in">echo</span> <span class="string">"Hello!"</span></span><br><span class="line">  now</span><br><span class="line">  <span class="built_in">bye</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">now</span></span>()&#123;</span><br><span class="line">  <span class="built_in">echo</span> <span class="string">"It's <span class="variable">$(date +%r)</span>"</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">bye</span></span>()&#123;</span><br><span class="line">  <span class="built_in">echo</span> <span class="string">"Bye bye."</span></span><br><span class="line">&#125;</span><br><span class="line">hello</span><br><span class="line"></span><br><span class="line"><span class="comment"># Output</span></span><br><span class="line"><span class="comment"># Hello!</span></span><br><span class="line"><span class="comment"># It's 09:29:44 PM</span></span><br><span class="line"><span class="comment"># Bye bye.</span></span><br></pre></td></tr></table></figure><p>但，需要注意函数的定义顺序。如果你在函数声明的前就去调用函数，函数就不会执行。如下， 在<code>hello</code>中执行<code>now</code>函数，但<code>now</code>是定义<code>hello</code>执行下面的，结果就会出错。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment"># this won't work</span></span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">hello</span></span>()&#123;</span><br><span class="line">  <span class="built_in">echo</span> <span class="string">"Hello!"</span></span><br><span class="line">  now</span><br><span class="line">&#125;</span><br><span class="line">hello</span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">now</span></span>()&#123;</span><br><span class="line">  <span class="built_in">echo</span> <span class="string">"It's <span class="variable">$(date +%r)</span>"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>输出：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ ./hello2.sh</span><br><span class="line">Hello!</span><br><span class="line">./hello2.sh: line 5: now: <span class="built_in">command</span> not found</span><br></pre></td></tr></table></figure><h4 id="函数传参"><a href="#函数传参" class="headerlink" title="函数传参"></a>函数传参</h4><p>和脚本执行的时候传参一样，函数的参数也用<code>$1</code>…,<code>$@</code> 来输出。</p><p>注意<code>$0</code>这里并不是函数的名字，而是当前脚本的名字。</p><p><code>$N</code>是第N个参数，<code>$@</code>表示所有的参数。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">fullname</span></span>()&#123;</span><br><span class="line">  <span class="built_in">echo</span> <span class="string">"<span class="variable">$0</span>"</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">"My name is <span class="variable">$1</span> <span class="variable">$2</span>"</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">fullname Razeen Cheng</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Output</span></span><br><span class="line"><span class="comment"># ./func.sh</span></span><br><span class="line"><span class="comment"># My name is Razeen Cheng</span></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">greeting</span></span>()&#123;</span><br><span class="line">  <span class="keyword">for</span> NAME <span class="keyword">in</span> <span class="variable">$@</span></span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"Hi <span class="variable">$NAME</span>."</span></span><br><span class="line">  <span class="keyword">done</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">greeting Tom Jerry</span><br></pre></td></tr></table></figure><h3 id="变量的作用域"><a href="#变量的作用域" class="headerlink" title="变量的作用域"></a>变量的作用域</h3><p>默认变量的作用域是全局的，必须先声明，后使用。 当然，最好在最上面就把需要的变量声明好。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="function"><span class="title">my_func</span></span>() &#123;</span><br><span class="line">  GLOBAL_VAR=1</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment"># 这时，变量还是空的</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"Calling GLONAL_VAR before calling function my_func"</span></span><br><span class="line"><span class="comment"># echo $GLOBAL_VAR</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 声明后，就可以输出了</span></span><br><span class="line">my_func</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"Calling GLONAL_VAR after calling function my_func"</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$GLOBAL_VAR</span></span><br></pre></td></tr></table></figure><h4 id="局部变量"><a href="#局部变量" class="headerlink" title="局部变量"></a>局部变量</h4><p>可以用<code>local</code>来定义局部变量，且只能在函数中使用。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash </span></span><br><span class="line">MY_VAR=1</span><br><span class="line"><span class="function"><span class="title">my_func</span></span> () &#123;</span><br><span class="line">  <span class="built_in">local</span> MY_VAR=2</span><br><span class="line">  <span class="built_in">echo</span> <span class="string">"my_func: MY_VAR=<span class="variable">$MY_VAR</span>"</span> </span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"global: MY_VAR=<span class="variable">$MY_VAR</span>"</span></span><br><span class="line">my_func</span><br></pre></td></tr></table></figure><h3 id="函数返回码"><a href="#函数返回码" class="headerlink" title="函数返回码"></a>函数返回码</h3><p>你可以在函数中，指定返回码:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">return 0</span><br></pre></td></tr></table></figure><p>函数中最后执行的命令的退出状态将隐式返回。 有效代码范围为0-255。<code>0</code>代表成功，<code>$?</code>可以显示退出码。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ my_function</span><br><span class="line">$ echo $?</span><br><span class="line">0</span><br></pre></td></tr></table></figure><p>可以在<code>if</code> 判断中用<code>$?</code> ：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 该函数用来创建一个备份文件</span></span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">backup_file</span></span> () &#123;</span><br><span class="line">    <span class="built_in">local</span> BACK <span class="comment"># 声明局部变量</span></span><br><span class="line">    <span class="keyword">if</span> [[ -f <span class="variable">$1</span> ]];<span class="keyword">then</span> <span class="comment"># 检查参数（是否是文件）</span></span><br><span class="line">        BACK=<span class="string">"/tmp/<span class="variable">$(basename "$1")</span>.<span class="variable">$(date +%F)</span>.$$"</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">"Backing up <span class="variable">$1</span> to <span class="variable">$BACK</span>"</span></span><br><span class="line">        cp <span class="string">"<span class="variable">$1</span>"</span> <span class="string">"<span class="variable">$BACK</span>"</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="comment"># 文件不存在.</span></span><br><span class="line">        <span class="built_in">return</span> 1</span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 调用函数</span></span><br><span class="line"><span class="keyword">if</span> [[ <span class="string">"<span class="variable">$1</span>"</span> ]]; <span class="keyword">then</span></span><br><span class="line">    backup_file <span class="string">"<span class="variable">$1</span>"</span></span><br><span class="line">    <span class="comment"># if [[ $? -eq 0 ]]; then</span></span><br><span class="line">    <span class="keyword">if</span> [[ $(backup_file <span class="string">"<span class="variable">$1</span>"</span>) -eq 0 ]]; <span class="keyword">then</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">"Backup succeeded."</span></span><br><span class="line">        <span class="built_in">exit</span> 0</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">"Backup failed."</span></span><br><span class="line">        <span class="comment"># 备份失败，中断，并返回非0状态.</span></span><br><span class="line">        <span class="built_in">exit</span> 1</span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    backup_file /etc/hosts</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"/etc/hosts Backup succeeded."</span></span><br><span class="line">    <span class="built_in">exit</span> 0</span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure><p>上面这个脚本默认备份<code>/etc/hosts</code>文件，除非你制定一个文件外。如果你指定一个文件参数，他会先检查文件，然后备份到<code>/tmp</code>目录。</p><p><code>$$</code> 返回 <a href="https://tldp.org/LDP/abs/html/internalvariables.html" target="_blank" rel="noopener">当前脚本执行的PID</a>. 每次运行PID都会发生变化。当你需要多次运行脚本时，或许对你有帮助。</p><p><code>basename ${1}</code> 可以从你输入的路径中提取文件的名字. 如 <code>basename /etc/hosts</code> 是 <code>hosts</code>.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ ls /tmp</span><br><span class="line">$ ex1           </span><br><span class="line">Backing up /etc/hosts to /tmp/hosts.2020-10-04.77124</span><br><span class="line">Backup succeeded.</span><br><span class="line">$ ls /tmp</span><br><span class="line">hosts.2020-10-04.77124</span><br></pre></td></tr></table></figure><h4 id="关键字-exit-和-return"><a href="#关键字-exit-和-return" class="headerlink" title="关键字 exit 和 return"></a>关键字 exit 和 return</h4><p><code>return</code> 会跳出当前函数, <code>exit</code>会结束当前脚本。</p><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>这篇博客总结了常用的，我们需要了解的一些脚本语法与知识。如果向更好的使用<code>bash</code>, 我们还需要进一步学习更多的命令等。希望这篇博客能对你有所帮助。</p><h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><ol><li><a href="https://tldp.org/LDP/Bash-Beginners-Guide/html/sect_03_02.html" target="_blank" rel="noopener">Variables</a>, <a href="https://tldp.org/LDP/abs/html/internalvariables.html" target="_blank" rel="noopener">Internal variables</a></li><li><a href="https://marketplace.visualstudio.com/items?itemName=timonwong.shellcheck" target="_blank" rel="noopener">shellcheck</a></li><li><a href="https://github.com/koalaman/shellcheck/wiki" target="_blank" rel="noopener">shellcheck wiki</a></li><li><a href="https://marketplace.visualstudio.com/items?itemName=foxundermoon.shell-format" target="_blank" rel="noopener">shell-format</a></li><li><a href="https://wiki.bash-hackers.org/start" target="_blank" rel="noopener">The Bash Hackers Wiki</a></li><li><a href="https://tldp.org/LDP/abs/html/index.html" target="_blank" rel="noopener">Advanced Bash-Scripting Guide</a></li></ol></div><div class="popular-posts-header">相关文章</div><ul class="popular-posts"><li class="popular-posts-item"><div class="popular-posts-title"><a href="/post/typora-upload-image-qiniu.html" rel="bookmark">Typora 自动上传图片到七牛云</a></div></li></ul><div class="reward-container"><div>如果觉得文章对您有帮助，点两下右边广告将是对我莫大的鼓励，非常感谢！</div><button onclick='var qr=document.getElementById("qr");qr.style.display="none"===qr.style.display?"block":"none"'>打赏</button><div id="qr" style="display:none"><div style="display:inline-block"><img src="https://st.razeen.cn/img/20210702001743-image-20210702001741636.png" alt="Razeen 微信支付"><p>微信支付</p></div></div></div><div class="followme"><p>欢迎关注我的其它发布渠道</p><div class="social-list"><div class="social-item"><a target="_blank" class="social-link" href="https://twitter.com/razeencheng"><span class="icon"><i class="fab fa-twitter"></i> </span><span class="label">Twitter</span></a></div><div class="social-item"><a target="_blank" class="social-link" href="/atom.xml"><span class="icon"><i class="fa fa-rss"></i> </span><span class="label">RSS</span></a></div></div></div><footer class="post-footer"><div class="post-tags"><a href="/tags/shell/" rel="tag"># shell</a> <a href="/tags/bash/" rel="tag"># bash</a></div><div class="post-nav"><div class="post-nav-item"><a href="/post/typora-upload-image-qiniu.html" rel="prev" title="Typora 自动上传图片到七牛云"><i class="fa fa-chevron-left"></i> Typora 自动上传图片到七牛云</a></div><div class="post-nav-item"><a href="/post/synology-hackintosh.html" rel="next" title="5分钟上手黑群晖 Nas">5分钟上手黑群晖 Nas <i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div class="tabs tabs-comment"><ul class="nav-tabs"><li class="tab"><a href="#comment-disqus">Disqus</a></li><li class="tab"><a href="#comment-gitalk">Gitalk</a></li></ul><div class="tab-content"><div class="tab-pane disqus" id="comment-disqus"><div class="comments"><div id="disqus_thread"><noscript>Please enable JavaScript to view the comments powered by Disqus.</noscript></div></div></div><div class="tab-pane gitalk" id="comment-gitalk"><div class="comments" id="gitalk-container"></div></div></div></div><script>window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }</script></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span> <span class="toggle-line toggle-line-middle"></span> <span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc">文章目录</li><li class="sidebar-nav-overview">站点概览</li></ul><div class="post-toc-wrap sidebar-panel"><div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#hello-world"><span class="nav-number">1.</span> <span class="nav-text">hello world</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#解释器"><span class="nav-number">2.</span> <span class="nav-text">解释器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#注释"><span class="nav-number">3.</span> <span class="nav-text">注释</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#变量声明"><span class="nav-number">4.</span> <span class="nav-text">变量声明</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#变量引用"><span class="nav-number">5.</span> <span class="nav-text">变量引用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#环境变量"><span class="nav-number">6.</span> <span class="nav-text">环境变量</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#内部变量"><span class="nav-number">7.</span> <span class="nav-text">内部变量</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#将命令输出分配给变量"><span class="nav-number">8.</span> <span class="nav-text">将命令输出分配给变量</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#内建命令"><span class="nav-number">9.</span> <span class="nav-text">内建命令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#测试"><span class="nav-number">10.</span> <span class="nav-text">测试</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#IF条件表达式"><span class="nav-number">10.1.</span> <span class="nav-text">IF条件表达式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#空格问题"><span class="nav-number">10.2.</span> <span class="nav-text">空格问题</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#文件测试表达式"><span class="nav-number">10.3.</span> <span class="nav-text">文件测试表达式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#字符串比较表达式"><span class="nav-number">10.4.</span> <span class="nav-text">字符串比较表达式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#数字比较表达式"><span class="nav-number">10.5.</span> <span class="nav-text">数字比较表达式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#双括号"><span class="nav-number">10.6.</span> <span class="nav-text">双括号 (())</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#怎么使用-if-else-和-if-elif-else"><span class="nav-number">11.</span> <span class="nav-text">怎么使用 if/else 和 if/elif/else</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#双中括号的使用"><span class="nav-number">12.</span> <span class="nav-text">双中括号的使用[[]]</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#怎么使用-For-循环"><span class="nav-number">13.</span> <span class="nav-text">怎么使用 For 循环</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#用-for-循环重命名文件"><span class="nav-number">13.1.</span> <span class="nav-text">用 for 循环重命名文件</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#怎么传参"><span class="nav-number">14.</span> <span class="nav-text">怎么传参</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#怎么接收用户输入"><span class="nav-number">15.</span> <span class="nav-text">怎么接收用户输入</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#用大括号来表示范围"><span class="nav-number">16.</span> <span class="nav-text">用大括号来表示范围 {}</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#怎么使用While"><span class="nav-number">17.</span> <span class="nav-text">怎么使用While</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#退出码-返回码-是什么？"><span class="nav-number">18.</span> <span class="nav-text">退出码/返回码 是什么？</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#怎么检查退出码"><span class="nav-number">18.1.</span> <span class="nav-text">怎么检查退出码</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#怎么连接多个命令"><span class="nav-number">19.</span> <span class="nav-text">怎么连接多个命令</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#逻辑运算符和命令退出状态"><span class="nav-number">19.1.</span> <span class="nav-text">逻辑运算符和命令退出状态</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#退出命令"><span class="nav-number">19.2.</span> <span class="nav-text">退出命令</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#逻辑与-amp-amp"><span class="nav-number">19.3.</span> <span class="nav-text">逻辑与 (&amp;&amp;)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#逻辑或"><span class="nav-number">19.4.</span> <span class="nav-text">逻辑或 (||)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#分号"><span class="nav-number">19.5.</span> <span class="nav-text">分号 (;)</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#管道"><span class="nav-number">20.</span> <span class="nav-text">管道 |</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#函数"><span class="nav-number">21.</span> <span class="nav-text">函数</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#函数传参"><span class="nav-number">21.1.</span> <span class="nav-text">函数传参</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#变量的作用域"><span class="nav-number">22.</span> <span class="nav-text">变量的作用域</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#局部变量"><span class="nav-number">22.1.</span> <span class="nav-text">局部变量</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#函数返回码"><span class="nav-number">23.</span> <span class="nav-text">函数返回码</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#关键字-exit-和-return"><span class="nav-number">23.1.</span> <span class="nav-text">关键字 exit 和 return</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#总结"><span class="nav-number">24.</span> <span class="nav-text">总结</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#参考"><span class="nav-number">25.</span> <span class="nav-text">参考</span></a></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" alt="Razeen" src="https://st.razeen.cn/static/img/avatar.png"><p class="site-author-name" itemprop="name">Razeen</p><div class="site-description" itemprop="description">My name is ChengJin, I use @Razeen and @RazeenCheng on web. I'm a gopher+. Currently I'm working for a company about information security.</div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">61</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/"><span class="site-state-item-count">25</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/"><span class="site-state-item-count">89</span> <span class="site-state-item-name">标签</span></a></div></nav></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/razeencheng" title="GitHub → https://github.com/razeencheng" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a> </span><span class="links-of-author-item"><a href="mailto:me@razeen.me" title="E-Mail → mailto:me@razeen.me" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a></span></div><div class="links-of-blogroll motion-element"><div class="links-of-blogroll-title"><i class="fa fa-link fa-fw"></i> 友情链接</div><ul class="links-of-blogroll-list"><li class="links-of-blogroll-item"><a href="https://yryz.net/" title="https://yryz.net/" rel="noopener" target="_blank">一人游走</a></li><li class="links-of-blogroll-item"><a href="https://deepzz.com/" title="https://deepzz.com/" rel="noopener" target="_blank">Deepzz</a></li><li class="links-of-blogroll-item"><a href="https://wangcch.cc/" title="https://wangcch.cc/" rel="noopener" target="_blank">Demon Wang</a></li><li class="links-of-blogroll-item"><a href="http://blog.tommyyang.cn/" title="http://blog.tommyyang.cn/" rel="noopener" target="_blank">Tommy Yang’s Blog</a></li></ul></div></div><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4450478767591566" data-ad-slot="8164928618" data-ad-format="auto" data-full-width-responsive="true"></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div></aside><div id="sidebar-dimmer"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright">&copy; <span itemprop="copyrightYear">2021</span> <span class="with-love"><i class="fa fa-heart"></i> </span><span class="author" itemprop="copyrightHolder">Razeen</span></div><div class="seal"><img style="width:auto;height:44px;cursor:pointer;display:inline-block;margin-right:5px" onclick='window.open("https://myssl.com/seal/detail?domain=razeencheng.com","TrustAsia 安全签章","height=800,width=470,top=0,right=0,toolbar=no,menubar=no,scrollbars=no,resizable=no,location=no,status=no")' src="https://sealres.trustasia.com/seal/img/1x/seal.png?domain=razeencheng.com" alt="TrustAsia 安全签章"></div></div></footer></div><script src="https://st.razeen.cn/next2021/lib/anime.min.js"></script><script src="https://st.razeen.cn/next2021/lib/fancybox/jquery.min.js"></script><script src="https://st.razeen.cn/next2021/lib/fancybox/jquery.fancybox.min.js"></script><script src="//cdn.jsdelivr.net/npm/lozad@1/dist/lozad.min.js"></script><script src="/js/utils.js"></script><script src="/js/schemes/pisces.js"></script><script src="/js/next-boot.js"></script><script src="/js/local-search.js"></script><script>!function(t,h,e,j){t.hj=t.hj||function(){(t.hj.q=t.hj.q||[]).push(arguments)},t._hjSettings={hjid:1271072,hjsv:6},e=h.getElementsByTagName("head")[0],(j=h.createElement("script")).async=1,j.src="https://static.hotjar.com/c/hotjar-"+t._hjSettings.hjid+".js?sv="+t._hjSettings.hjsv,e.appendChild(j)}(window,document)</script><script>var disqus_config=function(){this.page.url="https://razeencheng.com/post/the-ultimate-programmers-guide-to-bash-scripting.html",this.page.identifier="/post/the-ultimate-programmers-guide-to-bash-scripting.html",this.page.title="终极 Bash 脚本指南"};NexT.utils.loadComments(document.querySelector("#disqus_thread"),()=>{var e,t;window.DISQUS?DISQUS.reset({reload:!0,config:disqus_config}):((t=(e=document).createElement("script")).src="https://razeen-me.disqus.com/embed.js",t.setAttribute("data-timestamp",""+ +new Date),(e.head||e.body).appendChild(t))})</script><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.css"><script>NexT.utils.loadComments(document.querySelector("#gitalk-container"),()=>{NexT.utils.getScript("//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js",()=>{new Gitalk({clientID:"b18687c280aea769c18f",clientSecret:"a59a7ae4e158c9a80707e7ee1e13a3173fc34b7c",repo:"blog-comment",owner:"razeencheng",admin:["razeencheng"],id:"bbec696f9f584f4c4fe15f3164609cb6",language:"zh-CN",distractionFreeMode:!0}).render("gitalk-container")},window.Gitalk)})</script></body></html>